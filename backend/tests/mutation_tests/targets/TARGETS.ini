# Mutation Testing Targets Configuration
#
# Defines which code modules to test with mutation testing and their quality thresholds.

# Priority 1: Financial & Security (95% target)
# These are the most critical modules - cost leaks and security vulnerabilities
[priority_p0_financial]
modules = [
    "core/financial_ops_engine.py",
    "core/financial_forensics.py"
]
mutation_score_threshold = 95.0
description = "Financial operations - cost leak detection and budget guardrails"
risk_level = "CRITICAL"

[priority_p0_security]
modules = [
    "core/security.py",
    "core/security_dependencies.py",
    "core/enterprise_security.py"
]
mutation_score_threshold = 95.0
description = "Security operations - token encryption, rate limiting, JWT validation"
risk_level = "CRITICAL"

# Priority 2: Core Business Logic (90% target)
# Core platform functionality - episodes, agents, workflows
[priority_p1_episodes]
modules = [
    "core/episode_retrieval_service.py",
    "core/episode_segmentation_service.py",
    "core/episode_lifecycle_service.py",
    "core/episode_integration.py"
]
mutation_score_threshold = 90.0
description = "Episode management - retrieval, segmentation, lifecycle"
risk_level = "HIGH"

[priority_p1_agents]
modules = [
    "core/multi_agent_coordinator.py",
    "core/agent_governance_service.py",
    "core/governance_cache.py",
    "core/agent_context_resolver.py"
]
mutation_score_threshold = 90.0
description = "Agent coordination and governance"
risk_level = "HIGH"

[priority_p1_workflows]
modules = [
    "core/workflow_engine.py",
    "core/workflow_analytics_engine.py",
    "core/workflow_debugger.py"
]
mutation_score_threshold = 90.0
description = "Workflow execution and analytics"
risk_level = "HIGH"

# Priority 3: API & Tools (85% target)
# API routes and tool governance
[priority_p2_api]
modules = [
    "api/atom_agent_endpoints.py",
    "api/canvas_routes.py",
    "api/device_capabilities.py",
    "api/browser_routes.py"
]
mutation_score_threshold = 85.0
description = "API endpoints and routes"
risk_level = "MEDIUM"

[priority_p2_tools]
modules = [
    "tools/canvas_tool.py",
    "tools/device_tool.py",
    "tools/browser_tool.py"
]
mutation_score_threshold = 85.0
description = "Tool implementations with governance"
risk_level = "MEDIUM"

# Priority 4: Other (80% target)
[priority_p3_other]
modules = [
    "core/view_coordinator.py",
    "core/error_guidance_engine.py",
    "core/proposal_service.py",
    "core/supervision_service.py"
]
mutation_score_threshold = 80.0
description = "Other core services"
risk_level = "LOW"


# Test runner commands for each target
[runner_commands]
# Standard pytest runner
standard = "pytest tests/ -x -q --tb=line"

# With coverage
with_coverage = "pytest tests/ --cov=core --cov-report=term-missing"

# Property tests only
property_tests = "pytest tests/property_tests/ -v -m property"

# Specific test file
specific_file = "pytest tests/{test_file} -v"


# Mutation types to apply
[mutation_types]
# All mutation types enabled by default
operators = "arithmetic, boolean, comparison, conditional, lambda, statement, function_call"

# Exclude risky mutations in certain contexts
exclude = [
    # Don't mutate exception messages
    "exception_message",
    # Don't mutate logging statements
    "logging_statement",
    # Don't mutate type hints
    "type_hint"
]


# Mutation testing settings
[settings]
# Number of workers (parallel execution)
workers = "auto"

# Backup directory for surviving mutants
backup_dir = ".mutmut-backup"

# HTML output directory
output_dir = "html"

# Hypothesis settings for property-based tests during mutation
hypothesis_max_examples = 50  # Reduced for faster mutation testing

# Timeout for each mutation test run
timeout_ms = 5000

# Total time budget for mutation testing (in minutes)
time_budget_minutes = 120
