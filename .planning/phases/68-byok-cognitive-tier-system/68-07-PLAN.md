---
phase: 68-byok-cognitive-tier-system
plan: 07
type: execute
wave: 3
depends_on: [68-01, 68-05]
files_modified:
  - frontend-nextjs/components/Settings/CognitiveTierSettings.tsx
  - frontend-nextjs/components/Onboarding/CognitiveTierWizard.tsx
  - frontend-nextjs/components/Onboarding/TierSelector.tsx
  - frontend-nextjs/components/Onboarding/CostCalculator.tsx
  - frontend-nextjs/hooks/useCognitiveTier.ts
autonomous: true
user_setup: []

must_haves:
  truths:
    - Settings page for tier preference management with real-time cost estimates
    - 5-step onboarding wizard for cognitive tier selection
    - Interactive tier selector with quality vs cost comparison
    - Cost calculator showing projected monthly costs
    - All components use shadcn/ui for consistency
  artifacts:
    - path: frontend-nextjs/components/Settings/CognitiveTierSettings.tsx
      provides: Settings page for tier management
      min_lines: 300
    - path: frontend-nextjs/components/Onboarding/CognitiveTierWizard.tsx
      provides: Multi-step onboarding wizard
      min_lines: 400
    - path: frontend-nextjs/components/Onboarding/TierSelector.tsx
      provides: Interactive tier comparison UI
      min_lines: 250
    - path: frontend-nextjs/components/Onboarding/CostCalculator.tsx
      provides: Real-time cost estimation
      min_lines: 200
    - path: frontend-nextjs/hooks/useCognitiveTier.ts
      provides: React hook for tier API calls
      min_lines: 150
  key_links:
    - from: frontend-nextjs/components/Settings/CognitiveTierSettings.tsx
      to: /api/v1/cognitive-tier/preferences
      via: fetch('/api/v1/cognitive-tier/preferences/{workspace_id}')
      pattern: "fetch.*cognitive-tier"
    - from: frontend-nextjs/components/Onboarding/CognitiveTierWizard.tsx
      to: frontend-nextjs/hooks/useCognitiveTier.ts
      via: import { useCognitiveTier } from '@/hooks/useCognitiveTier'
      pattern: "import.*useCognitiveTier"
    - from: frontend-nextjs/components/Onboarding/TierSelector.tsx
      to: /api/v1/cognitive-tier/compare-tiers
      via: fetch('/api/v1/cognitive-tier/compare-tiers')
      pattern: "fetch.*compare-tiers"

## Objective

Create the frontend UI for cognitive tier management including a settings page and onboarding wizard. The UI enables users to select their preferred cognitive tier, see cost comparisons, and understand the quality vs cost tradeoffs. All components use existing shadcn/ui components for consistency.

**Purpose:** Provide user-friendly interface for cognitive tier configuration and cost-aware decision making.

**Output:** Complete settings page, onboarding wizard, and supporting components.

## Context

@/Users/rushiparikh/projects/atom/.planning/phases/68-byok-cognitive-tier-system/68-RESEARCH.md
@/Users/rushiparikh/projects/atom/frontend-nextjs/components/Settings/PreferencesTab.tsx (existing pattern)
@/Users/rushiparikh/projects/atom/frontend-nextjs/components/ui (shadcn/ui components)

## Tasks

<task type="auto">
  <name>Task 1: Create useCognitiveTier React hook</name>
  <files>frontend-nextjs/hooks/useCognitiveTier.ts</files>
  <action>
Create new file `frontend-nextjs/hooks/useCognitiveTier.ts` with:

```typescript
import { useState, useEffect } from 'react';

export interface TierPreference {
  id: string;
  workspace_id: string;
  default_tier: string;
  min_tier: string | null;
  max_tier: string | null;
  monthly_budget_cents: number | null;
  max_cost_per_request_cents: number | null;
  enable_cache_aware_routing: boolean;
  enable_auto_escalation: boolean;
  enable_minimax_fallback: boolean;
  preferred_providers: string[];
}

export interface CostEstimate {
  tier: string;
  estimated_cost_usd: number;
  models_in_tier: string[];
}

export interface TierComparison {
  tier: string;
  quality_range: string;
  cost_range: string;
  example_models: string[];
  supports_cache: boolean;
}

const workspaceId = "default"; // TODO: Get from context

export function useCognitiveTier() {
  const [preferences, setPreferences] = useState<TierPreference | null>(null);
  const [loading, setLoading] = useState(true);
  const [saving, setSaving] = useState(false);

  // Fetch preferences
  const fetchPreferences = async () => {
    setLoading(true);
    try {
      const res = await fetch(`/api/v1/cognitive-tier/preferences/${workspaceId}`);
      if (res.ok) {
        const data = await res.json();
        setPreferences(data);
      }
    } catch (error) {
      console.error("Failed to fetch tier preferences:", error);
    } finally {
      setLoading(false);
    }
  };

  // Save preferences
  const savePreferences = async (prefs: Partial<TierPreference>) => {
    setSaving(true);
    try {
      const res = await fetch(`/api/v1/cognitive-tier/preferences/${workspaceId}`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ workspace_id: workspaceId, ...prefs }),
      });
      if (res.ok) {
        const data = await res.json();
        setPreferences(data);
        return true;
      }
    } catch (error) {
      console.error("Failed to save tier preferences:", error);
    } finally {
      setSaving(false);
    }
    return false;
  };

  // Estimate cost
  const estimateCost = async (prompt: string, estimatedTokens?: number): Promise<CostEstimate[]> => {
    try {
      const params = new URLSearchParams({ prompt });
      if (estimatedTokens) params.append("estimated_tokens", estimatedTokens.toString());
      const res = await fetch(`/api/v1/cognitive-tier/estimate-cost?${params}`);
      if (res.ok) {
        return await res.json();
      }
    } catch (error) {
      console.error("Failed to estimate cost:", error);
    }
    return [];
  };

  // Compare tiers
  const compareTiers = async (): Promise<TierComparison[]> => {
    try {
      const res = await fetch("/api/v1/cognitive-tier/compare-tiers");
      if (res.ok) {
        return await res.json();
      }
    } catch (error) {
      console.error("Failed to compare tiers:", error);
    }
    return [];
  };

  useEffect(() => {
    fetchPreferences();
  }, []);

  return {
    preferences,
    loading,
    saving,
    fetchPreferences,
    savePreferences,
    estimateCost,
    compareTiers,
  };
}
```

DO NOT include any UI components - this is a data hook only.

Export all interfaces for use in components.
</action>
  <verify>
# TypeScript compilation check
cd frontend-nextjs && npx tsc --noEmit hooks/useCognitiveTier.ts
  </verify>
  <done>
useCognitiveTier hook created with fetchPreferences, savePreferences, estimateCost, compareTiers methods, TypeScript types exported
</done>
</task>

<task type="auto">
  <name>Task 2: Create CognitiveTierSettings component</name>
  <files>frontend-nextjs/components/Settings/CognitiveTierSettings.tsx</files>
  <action>
Create new file `frontend-nextjs/components/Settings/CognitiveTierSettings.tsx` with:

```typescript
import React, { useEffect, useState } from 'react';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Label } from "@/components/ui/label";
import { Switch } from "@/components/ui/switch";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { toast } from "sonner";
import { Loader2 } from "lucide-react";
import { useCognitiveTier } from "@/hooks/useCognitiveTier";

const TIERS = [
  { value: "micro", label: "Micro", description: "Simple queries <100 tokens" },
  { value: "standard", label: "Standard", description: "Moderate complexity 100-500 tokens" },
  { value: "versatile", label: "Versatile", description: "Multi-step reasoning 500-2k tokens" },
  { value: "heavy", label: "Heavy", description: "Complex tasks 2k-5k tokens" },
  { value: "complex", label: "Complex", description: "Frontier reasoning >5k tokens" },
];

export function CognitiveTierSettings() {
  const { preferences, loading, saving, savePreferences, estimateCost } = useCognitiveTier();
  const [localPrefs, setLocalPrefs] = useState(preferences);
  const [estimatedCost, setEstimatedCost] = useState<number | null>(null);

  useEffect(() => {
    setLocalPrefs(preferences);
  }, [preferences]);

  const handleSave = async (key: string, value: any) => {
    const updated = { ...localPrefs, [key]: value };
    setLocalPrefs(updated);
    const success = await savePreferences(updated);
    if (success) {
      toast.success("Tier preference saved");
    } else {
      toast.error("Failed to save preference");
    }
  };

  const handleEstimateCost = async () => {
    const costs = await estimateCost("What is the capital of France?", 20);
    if (costs.length > 0) {
      const tier = localPrefs?.default_tier || "standard";
      const cost = costs.find(c => c.tier === tier);
      if (cost) {
        setEstimatedCost(cost.estimated_cost_usd * 1000000); // Per 1M tokens
      }
    }
  };

  if (loading) {
    return (
      <div className="flex justify-center p-10">
        <Loader2 className="h-8 w-8 animate-spin" />
      </div>
    );
  }

  return (
    <div className="space-y-6">
      {/* Default Tier Selection */}
      <Card>
        <CardHeader>
          <CardTitle>Default Cognitive Tier</CardTitle>
          <CardDescription>Select your preferred tier for AI queries</CardDescription>
        </CardHeader>
        <CardContent className="space-y-4">
          <div className="flex items-center justify-between">
            <div className="space-y-0.5">
              <Label>Default Tier</Label>
              <div className="text-sm text-muted-foreground">
                Higher tiers = better quality but higher cost
              </div>
            </div>
            <Select
              value={localPrefs?.default_tier || "standard"}
              onValueChange={(val) => handleSave("default_tier", val)}
            >
              <SelectTrigger className="w-[200px]">
                <SelectValue />
              </SelectTrigger>
              <SelectContent>
                {TIERS.map((tier) => (
                  <SelectItem key={tier.value} value={tier.value}>
                    {tier.label} - {tier.description}
                  </SelectItem>
                ))}
              </SelectContent>
            </Select>
          </div>

          {/* Cost Estimate Button */}
          <Button onClick={handleEstimateCost} variant="outline" className="mt-4">
            Estimate Cost (Per 1M Tokens)
          </Button>
          {estimatedCost !== null && (
            <div className="text-sm">
              Estimated: ${estimatedCost.toFixed(2)} per 1M tokens
            </div>
          )}
        </CardContent>
      </Card>

      {/* Feature Flags */}
      <Card>
        <CardHeader>
          <CardTitle>Smart Routing Features</CardTitle>
          <CardDescription>Enable cost optimization features</CardDescription>
        </CardHeader>
        <CardContent className="space-y-4">
          <div className="flex items-center justify-between">
            <div className="space-y-0.5">
              <Label>Cache-Aware Routing</Label>
              <div className="text-sm text-muted-foreground">
                Use prompt caching to reduce costs (up to 90% savings)
              </div>
            </div>
            <Switch
              checked={localPrefs?.enable_cache_aware_routing ?? true}
              onCheckedChange={(val) => handleSave("enable_cache_aware_routing", val)}
            />
          </div>

          <div className="flex items-center justify-between">
            <div className="space-y-0.5">
              <Label>Auto-Escalation</Label>
              <div className="text-sm text-muted-foreground">
                Automatically upgrade tier on quality issues
              </div>
            </div>
            <Switch
              checked={localPrefs?.enable_auto_escalation ?? true}
              onCheckedChange={(val) => handleSave("enable_auto_escalation", val)}
            />
          </div>

          <div className="flex items-center justify-between">
            <div className="space-y-0.5">
              <Label>MiniMax Fallback</Label>
              <div className="text-sm text-muted-foreground">
                Use MiniMax M2.5 for cost-effective standard tier queries
              </div>
            </div>
            <Switch
              checked={localPrefs?.enable_minimax_fallback ?? true}
              onCheckedChange={(val) => handleSave("enable_minimax_fallback", val)}
            />
          </div>
        </CardContent>
      </Card>

      {/* Budget Controls */}
      <Card>
        <CardHeader>
          <CardTitle>Cost Controls</CardTitle>
          <CardDescription>Set limits to control spending</CardDescription>
        </CardHeader>
        <CardContent className="space-y-4">
          <div className="space-y-2">
            <Label>Monthly Budget (USD)</Label>
            <Input
              type="number"
              placeholder="No limit"
              value={localPrefs?.monthly_budget_cents ? localPrefs.monthly_budget_cents / 100 : ""}
              onChange={(e) => handleSave("monthly_budget_cents", e.target.value ? parseFloat(e.target.value) * 100 : null)}
            />
          </div>

          <div className="space-y-2">
            <Label>Max Cost Per Request (USD)</Label>
            <Input
              type="number"
              placeholder="No limit"
              value={localPrefs?.max_cost_per_request_cents ? localPrefs.max_cost_per_request_cents / 100 : ""}
              onChange={(e) => handleSave("max_cost_per_request_cents", e.target.value ? parseFloat(e.target.value) * 100 : null)}
            />
          </div>
        </CardContent>
      </Card>
    </div>
  );
}
```

DO NOT use external form libraries - use controlled inputs with useState.
</action>
  <verify>
# TypeScript compilation check
cd frontend-nextjs && npx tsc --noEmit components/Settings/CognitiveTierSettings.tsx
  </verify>
  <done>
CognitiveTierSettings component created with tier selection, feature flags, budget controls, cost estimation, all using shadcn/ui components
</done>
</task>

<task type="auto">
  <name>Task 3: Create TierSelector component</name>
  <files>frontend-nextjs/components/Onboarding/TierSelector.tsx</files>
  <action>
Create new file `frontend-nextjs/components/Onboarding/TierSelector.tsx` with:

```typescript
import React, { useState, useEffect } from 'react';
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { Check } from "lucide-react";
import { useCognitiveTier, TierComparison } from "@/hooks/useCognitiveTier";

interface TierSelectorProps {
  selectedTier: string;
  onTierSelect: (tier: string) => void;
}

const TIER_DESCRIPTIONS = {
  micro: {
    name: "Micro",
    description: "Fast, efficient responses for simple queries",
    use_cases: ["Quick questions", "Summaries", "Translations"],
    color: "bg-green-500",
  },
  standard: {
    name: "Standard",
    description: "Balanced quality and cost for everyday tasks",
    use_cases: ["Explanations", "Analysis", "Content creation"],
    color: "bg-blue-500",
  },
  versatile: {
    name: "Versatile",
    description: "Multi-step reasoning with good quality",
    use_cases: ["Problem solving", "Planning", "Optimization"],
    color: "bg-purple-500",
  },
  heavy: {
    name: "Heavy",
    description: "Complex tasks requiring deep reasoning",
    use_cases: ["Architecture", "Security audits", "Research"],
    color: "bg-orange-500",
  },
  complex: {
    name: "Complex",
    description: "Frontier models for the most demanding tasks",
    use_cases: ["Math proofs", "Code generation", "Advanced analysis"],
    color: "bg-red-500",
  },
};

export function TierSelector({ selectedTier, onTierSelect }: TierSelectorProps) {
  const { compareTiers } = useCognitiveTier();
  const [comparisons, setComparisons] = useState<TierComparison[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    compareTiers().then(data => {
      setComparisons(data);
      setLoading(false);
    });
  }, [compareTiers]);

  const getCostBadge = (tier: string) => {
    const comp = comparisons.find(c => c.tier === tier);
    if (!comp) return <Badge variant="outline">Loading...</Badge>;
    const cost = parseFloat(comp.cost_range);
    if (cost < 0.5) return <Badge className="bg-green-100 text-green-800">$</Badge>;
    if (cost < 5) return <Badge className="bg-blue-100 text-blue-800">$$</Badge>;
    return <Badge className="bg-orange-100 text-orange-800">$$$</Badge>;
  };

  const getQualityBadge = (tier: string) => {
    const comp = comparisons.find(c => c.tier === tier);
    if (!comp) return <Badge variant="outline">Loading...</Badge>;
    const quality = parseInt(comp.quality_range);
    if (quality < 80) return <Badge variant="secondary">Basic</Badge>;
    if (quality < 90) return <Badge className="bg-blue-100 text-blue-800">Good</Badge>;
    return <Badge className="bg-purple-100 text-purple-800">Excellent</Badge>;
  };

  return (
    <div className="grid grid-cols-1 md:grid-cols-5 gap-4">
      {Object.entries(TIER_DESCRIPTIONS).map(([key, tier]) => (
        <Card
          key={key}
          className={`cursor-pointer transition-all ${
            selectedTier === key ? "ring-2 ring-blue-500" : "hover:shadow-md"
          }`}
          onClick={() => onTierSelect(key)}
        >
          <CardContent className="p-4">
            <div className="flex justify-between items-start mb-2">
              <div className={`w-3 h-3 rounded-full ${tier.color}`} />
              {selectedTier === key && <Check className="h-5 w-5 text-blue-500" />}
            </div>
            <h3 className="font-semibold">{tier.name}</h3>
            <p className="text-sm text-muted-foreground mb-3">{tier.description}</p>
            <div className="space-y-1">
              {getCostBadge(key)}
              {getQualityBadge(key)}
            </div>
            <ul className="text-xs text-muted-foreground mt-2 space-y-1">
              {tier.use_cases.map(use_case => (
                <li key={use_case}>• {use_case}</li>
              ))}
            </ul>
          </CardContent>
        </Card>
      ))}
    </div>
  );
}
```

DO NOT include complex animations - keep simple and performant.
</action>
  <verify>
# TypeScript compilation check
cd frontend-nextjs && npx tsc --noEmit components/Onboarding/TierSelector.tsx
  </verify>
  <done>
TierSelector component created with visual tier cards, cost/quality badges, use case lists, selection indicator
</done>
</task>

<task type="auto">
  <name>Task 4: Create CostCalculator component</name>
  <files>frontend-nextjs/components/Onboarding/CostCalculator.tsx</files>
  <action>
Create new file `frontend-nextjs/components/Onboarding/CostCalculator.tsx` with:

```typescript
import React, { useState, useEffect } from 'react';
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Slider } from "@/components/ui/slider";
import { useCognitiveTier } from "@/hooks/useCognitiveTier";

interface CostCalculatorProps {
  selectedTier: string;
}

export function CostCalculator({ selectedTier }: CostCalculatorProps) {
  const { estimateCost } = useCognitiveTier();
  const [prompt, setPrompt] = useState("");
  const [requestsPerDay, setRequestsPerDay] = useState([100]);
  const [estimatedCost, setEstimatedCost] = useState<number | null>(null);

  useEffect(() => {
    const calculateCost = async () => {
      if (!prompt) {
        setEstimatedCost(null);
        return;
      }
      const costs = await estimateCost(prompt);
      const tierCost = costs.find(c => c.tier === selectedTier);
      if (tierCost) {
        const monthlyRequests = requestsPerDay[0] * 30;
        const costPerRequest = tierCost.estimated_cost_usd;
        setEstimatedCost(costPerRequest * monthlyRequests);
      }
    };
    calculateCost();
  }, [prompt, requestsPerDay, selectedTier, estimateCost]);

  return (
    <Card>
      <CardHeader>
        <CardTitle>Cost Calculator</CardTitle>
      </CardHeader>
      <CardContent className="space-y-4">
        <div className="space-y-2">
          <Label>Sample Prompt</Label>
          <Input
            placeholder="Enter a sample query..."
            value={prompt}
            onChange={(e) => setPrompt(e.target.value)}
          />
        </div>

        <div className="space-y-2">
          <Label>Requests Per Day: {requestsPerDay[0]}</Label>
          <Slider
            value={requestsPerDay}
            onValueChange={setRequestsPerDay}
            min={10}
            max={1000}
            step={10}
          />
        </div>

        {estimatedCost !== null && (
          <div className="p-4 bg-blue-50 rounded-lg">
            <div className="text-2xl font-bold">
              ${estimatedCost.toFixed(2)}
            </div>
            <div className="text-sm text-muted-foreground">Estimated monthly cost</div>
          </div>
        )}

        <div className="text-xs text-muted-foreground">
          * Estimates based on {selectedTier} tier. Actual costs may vary.
        </div>
      </CardContent>
    </Card>
  );
}
```

DO NOT implement complex chart visualizations - keep simple text-based display.
</action>
  <verify>
# TypeScript compilation check
cd frontend-nextjs && npx tsc --noEmit components/Onboarding/CostCalculator.tsx
  </verify>
  <done>
CostCalculator component created with prompt input, requests per day slider, real-time cost estimation, monthly cost display
</done>
</task>

<task type="auto">
  <name>Task 5: Create CognitiveTierWizard component</name>
  <files>frontend-nextjs/components/Onboarding/CognitiveTierWizard.tsx</files>
  <action>
Create new file `frontend-nextjs/components/Onboarding/CognitiveTierWizard.tsx` with:

```typescript
import React, { useState } from 'react';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { ArrowRight, ArrowLeft, Check } from "lucide-react";
import { TierSelector } from "./TierSelector";
import { CostCalculator } from "./CostCalculator";
import { useCognitiveTier } from "@/hooks/useCognitiveTier";
import { toast } from "sonner";

type Step = "welcome" | "select" | "budget" | "review" | "complete";

export function CognitiveTierWizard() {
  const [step, setStep] = useState<Step>("welcome");
  const [selectedTier, setSelectedTier] = useState("standard");
  const [monthlyBudget, setMonthlyBudget] = useState<number | null>(null);
  const { savePreferences, saving } = useCognitiveTier();

  const steps: Step[] = ["welcome", "select", "budget", "review", "complete"];
  const currentStepIndex = steps.indexOf(step);

  const handleNext = () => {
    if (currentStepIndex < steps.length - 1) {
      setStep(steps[currentStepIndex + 1]);
    }
  };

  const handleBack = () => {
    if (currentStepIndex > 0) {
      setStep(steps[currentStepIndex - 1]);
    }
  };

  const handleComplete = async () => {
    const success = await savePreferences({
      default_tier: selectedTier,
      monthly_budget_cents: monthlyBudget ? monthlyBudget * 100 : null,
      enable_cache_aware_routing: true,
      enable_auto_escalation: true,
    });

    if (success) {
      setStep("complete");
      toast.success("Cognitive tier preferences saved!");
    } else {
      toast.error("Failed to save preferences");
    }
  };

  return (
    <div className="max-w-4xl mx-auto p-6">
      {/* Progress indicator */}
      <div className="flex justify-between mb-8">
        {steps.map((s, i) => (
          <div
            key={s}
            className={`flex items-center ${
              i <= currentStepIndex ? "text-blue-500" : "text-muted-foreground"
            }`}
          >
            <div className={`w-8 h-8 rounded-full flex items-center justify-center ${
              i < currentStepIndex ? "bg-blue-500 text-white" : "border-2"
            }`}>
              {i < currentStepIndex ? <Check className="h-4 w-4" /> : i + 1}
            </div>
            {i < steps.length - 1 && <div className="w-16 h-0.5 bg-gray-200 mx-2" />}
          </div>
        ))}
      </div>

      {/* Step content */}
      {step === "welcome" && (
        <Card>
          <CardHeader>
            <CardTitle>Welcome to Cognitive Tier Configuration</CardTitle>
            <CardDescription>
              Choose how Atom AI routes your queries to optimize for cost and quality
            </CardDescription>
          </CardHeader>
          <CardContent>
            <p className="mb-4">
              Atom uses a 5-tier cognitive system to match your queries with the most cost-effective models.
            </p>
            <ul className="list-disc pl-6 space-y-2">
              <li><strong>Micro:</strong> Simple queries, fastest response</li>
              <li><strong>Standard:</strong> Everyday tasks, balanced cost</li>
              <li><strong>Versatile:</strong> Complex reasoning, better quality</li>
              <li><strong>Heavy:</strong> Advanced tasks, frontier models</li>
              <li><strong>Complex:</strong> Most demanding queries, highest quality</li>
            </ul>
          </CardContent>
        </Card>
      )}

      {step === "select" && (
        <Card>
          <CardHeader>
            <CardTitle>Select Your Default Tier</CardTitle>
            <CardDescription>
              Choose the tier that best matches your typical usage
            </CardDescription>
          </CardHeader>
          <CardContent>
            <TierSelector selectedTier={selectedTier} onTierSelect={setSelectedTier} />
          </CardContent>
        </Card>
      )}

      {step === "budget" && (
        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
          <Card>
            <CardHeader>
              <CardTitle>Set Budget Limits (Optional)</CardTitle>
              <CardDescription>
                Control your monthly spending
              </CardDescription>
            </CardHeader>
            <CardContent>
              <label className="block mb-2 text-sm font-medium">
                Monthly Budget (USD)
              </label>
              <input
                type="number"
                className="w-full p-2 border rounded"
                placeholder="No limit"
                value={monthlyBudget || ""}
                onChange={(e) => setMonthlyBudget(e.target.value ? parseFloat(e.target.value) : null)}
              />
              <p className="text-xs text-muted-foreground mt-2">
                Leave empty for no budget limit
              </p>
            </CardContent>
          </Card>

          <CostCalculator selectedTier={selectedTier} />
        </div>
      )}

      {step === "review" && (
        <Card>
          <CardHeader>
            <CardTitle>Review Your Selection</CardTitle>
            <CardDescription>
              Confirm your cognitive tier preferences
            </CardDescription>
          </CardHeader>
          <CardContent>
            <div className="space-y-4">
              <div>
                <span className="font-medium">Default Tier:</span> {selectedTier}
              </div>
              <div>
                <span className="font-medium">Monthly Budget:</span> {monthlyBudget ? `$${monthlyBudget}` : "No limit"}
              </div>
              <div>
                <span className="font-medium">Cache-Aware Routing:</span> Enabled
              </div>
              <div>
                <span className="font-medium">Auto-Escalation:</span> Enabled
              </div>
            </div>
          </CardContent>
        </Card>
      )}

      {step === "complete" && (
        <Card>
          <CardHeader>
            <CardTitle className="text-center">Configuration Complete!</CardTitle>
          </CardHeader>
          <CardContent>
            <p className="text-center text-muted-foreground">
              Your cognitive tier preferences have been saved. Atom will now route your queries
              according to your selected tier and budget limits.
            </p>
          </CardContent>
        </Card>
      )}

      {/* Navigation buttons */}
      {step !== "complete" && (
        <div className="flex justify-between mt-6">
          <Button
            variant="outline"
            onClick={handleBack}
            disabled={currentStepIndex === 0}
          >
            <ArrowLeft className="h-4 w-4 mr-2" />
            Back
          </Button>

          {step === "review" ? (
            <Button onClick={handleComplete} disabled={saving}>
              Complete Setup
              {saving && <span className="ml-2 animate-spin">⏳</span>}
            </Button>
          ) : (
            <Button onClick={handleNext}>
              {step === "welcome" ? "Get Started" : "Next"}
              <ArrowRight className="h-4 w-4 ml-2" />
            </Button>
          )}
        </div>
      )}
    </div>
  );
}
```

DO NOT add complex animations - keep transitions simple.
</action>
  <verify>
# TypeScript compilation check
cd frontend-nextjs && npx tsc --noEmit components/Onboarding/CognitiveTierWizard.tsx
  </verify>
  <done>
CognitiveTierWizard component created with 5-step flow, progress indicator, navigation, integration with all sub-components
</done>
</task>

## Verification

1. **TypeScript compiles without errors**:
   ```bash
   cd frontend-nextjs && npx tsc --noEmit
   ```

2. **Components import correctly**:
   ```bash
   cd frontend-nextjs && node -e "
   const fs = require('fs');
   const files = [
     'hooks/useCognitiveTier.ts',
     'components/Settings/CognitiveTierSettings.tsx',
     'components/Onboarding/TierSelector.tsx',
     'components/Onboarding/CostCalculator.tsx',
     'components/Onboarding/CognitiveTierWizard.tsx'
   ];
   files.forEach(f => console.log(f, fs.existsSync(f) ? 'exists' : 'missing'));
   "
   ```

3. **shadcn/ui components used** (Card, Button, Input, Label, Slider, Switch, Select, Badge)

4. **API endpoints match backend**: /api/v1/cognitive-tier/* paths

## Success Criteria

1. useCognitiveTier hook with all API methods (fetchPreferences, savePreferences, estimateCost, compareTiers)
2. CognitiveTierSettings component with tier selection, feature flags, budget controls
3. TierSelector component with visual tier cards and selection indicator
4. CostCalculator component with real-time cost estimation
5. CognitiveTierWizard component with 5-step onboarding flow
6. All components use existing shadcn/ui components (no new dependencies)
7. TypeScript compiles without errors

## Output

After completion, create `.planning/phases/68-byok-cognitive-tier-system/68-07-SUMMARY.md` with:
- Component screenshots (if possible) or descriptions
- TypeScript compilation status
- API integration verification
- User flow documentation
