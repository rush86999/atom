---
phase: 08.5-coverage-expansion
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - backend/tests/unit/test_workflow_template_system.py
  - backend/tests/unit/test_workflow_parameter_validator.py
  - backend/tests/unit/test_workflow_ui_endpoints.py
  - backend/tests/unit/test_workflow_template_endpoints.py
autonomous: true

must_haves:
  truths:
    - "workflow_template_system.py has baseline test coverage for template CRUD operations"
    - "workflow_parameter_validator.py has baseline test coverage for validation rules"
    - "workflow_ui_endpoints.py has baseline test coverage for UI-specific endpoints"
    - "workflow_template_endpoints.py has baseline test coverage for template API routes"
    - "All four files show >0% coverage in coverage report"
  artifacts:
    - path: "backend/tests/unit/test_workflow_template_system.py"
      provides: "Template system unit tests"
      min_lines: 200
    - path: "backend/tests/unit/test_workflow_parameter_validator.py"
      provides: "Parameter validation unit tests"
      min_lines: 150
    - path: "backend/tests/unit/test_workflow_ui_endpoints.py"
      provides: "UI endpoints unit tests"
      min_lines: 150
    - path: "backend/tests/unit/test_workflow_template_endpoints.py"
      provides: "Template API endpoints unit tests"
      min_lines: 150
  key_links:
    - from: "backend/tests/unit/test_workflow_template_system.py"
      to: "core/workflow_template_system.py"
      via: "direct import and testing"
      pattern: "from core.workflow_template_system import"
    - from: "backend/tests/unit/test_workflow_parameter_validator.py"
      to: "core/workflow_parameter_validator.py"
      via: "direct import and testing"
      pattern: "from core.workflow_parameter_validator import"
---

<objective>
Create baseline unit tests for 4 medium-sized zero-coverage workflow-related files to establish measurable coverage progress.

**Purpose:** Target medium-complexity files (250-350 lines) for efficient baseline coverage. These files represent workflow infrastructure that is testable with moderate mocking effort.

**Output:** 4 new test files with ~650 lines total, achieving 30-50% coverage on target files.
</objective>

<execution_context>
@/Users/rushiparikh/.claude/get-shit-done/workflows/execute-plan.md
@/Users/rushiparikh/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/08-80-percent-coverage-push/08-80-percent-coverage-push-02-SUMMARY.md
@.planning/phases/08-80-percent-coverage-push/08-80-percent-coverage-push-08-SUMMARY.md
@backend/tests/unit/test_workflow_engine.py
@backend/tests/unit/test_atom_agent_endpoints.py
@backend/tests/conftest.py
</context>

<tasks>

<task type="auto">
  <name>Create baseline tests for workflow_template_system.py</name>
  <files>backend/tests/unit/test_workflow_template_system.py</files>
  <action>
    Create test file for core/workflow_template_system.py (356 lines):

    1. Import pattern: Follow established pattern from test_workflow_engine.py
    2. Fixtures:
       - mock_template_store: AsyncMock for template storage operations
       - mock_validator: AsyncMock for template validation
       - sample_template: Dict with template structure (id, name, steps, parameters)
    3. Test classes:
       - TestTemplateSystemInit: Test initialization, configuration
       - TestTemplateCRUD: Test create_template, get_template, list_templates, update_template, delete_template
       - TestTemplateValidation: Test schema validation, required fields
       - TestTemplateVersioning: Test version tracking, rollback if applicable
    4. Use AsyncMock for all async dependencies
    5. Test both success and error cases
    6. Target: ~200 lines, 15-20 tests

    Reference pattern from test_workflow_engine.py lines 32-119 for fixture structure.
  </action>
  <verify>pytest backend/tests/unit/test_workflow_template_system.py -v --cov=core/workflow_template_system --cov-report=term-missing</verify>
  <done>Test file exists with 15+ tests, coverage shows >0% for workflow_template_system.py</done>
</task>

<task type="auto">
  <name>Create baseline tests for workflow_parameter_validator.py</name>
  <files>backend/tests/unit/test_workflow_parameter_validator.py</files>
  <action>
    Create test file for core/workflow_parameter_validator.py (286 lines):

    1. Import pattern: Follow established pattern from test_workflow_engine.py
    2. Fixtures:
       - validator_instance: Direct instantiation of validator class
       - sample_schema: Dict with JSON schema structure
       - valid_params: Dict with valid parameter values
       - invalid_params: Dict with various invalid values
    3. Test classes:
       - TestValidatorInit: Test initialization, config loading
       - TestParameterValidation: Test validate_parameters, type checking, required fields
       - TestSchemaValidation: Test schema parsing, complex types (array, object)
       - TestErrorHandling: Test ValidationError raising, error messages
    4. Parameterized tests for different data types using @pytest.mark.parametrize
    5. Target: ~150 lines, 12-15 tests

    Use pytest.mark.parametrize for testing multiple invalid input types.
  </action>
  <verify>pytest backend/tests/unit/test_workflow_parameter_validator.py -v --cov=core/workflow_parameter_validator --cov-report=term-missing</verify>
  <done>Test file exists with 12+ tests, coverage shows >0% for workflow_parameter_validator.py</done>
</task>

<task type="auto">
  <name>Create baseline tests for workflow_ui_endpoints.py and workflow_template_endpoints.py</name>
  <files>backend/tests/unit/test_workflow_ui_endpoints.py backend/tests/unit/test_workflow_template_endpoints.py</files>
  <action>
    Create test files for core/workflow_ui_endpoints.py (312 lines) and core/workflow_template_endpoints.py (276 lines):

    For test_workflow_ui_endpoints.py:
    1. Follow FastAPI TestClient pattern from test_atom_agent_endpoints.py lines 42-54
    2. Fixtures: app, client, mock_service_layer
    3. Test UI-specific endpoints (component rendering, layout data, UI config)
    4. Target: ~150 lines, 10-12 tests

    For test_workflow_template_endpoints.py:
    1. Same FastAPI TestClient pattern
    2. Fixtures: app, client, mock_template_service
    3. Test template CRUD endpoints (POST /templates, GET /templates, PUT /templates/{id})
    4. Target: ~150 lines, 10-12 tests

    Use @patch decorator for mocking service layer dependencies in endpoints.
  </action>
  <verify>pytest backend/tests/unit/test_workflow_ui_endpoints.py backend/tests/unit/test_workflow_template_endpoints.py -v --cov=core/workflow_ui_endpoints --cov=core/workflow_template_endpoints --cov-report=term-missing</verify>
  <done>Both test files exist with 10+ tests each, coverage shows >0% for both files</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. Run: pytest backend/tests/unit/test_workflow_template_system.py backend/tests/unit/test_workflow_parameter_validator.py backend/tests/unit/test_workflow_ui_endpoints.py backend/tests/unit/test_workflow_template_endpoints.py -v
2. Verify: All 4 files show >0% coverage in: pytest --cov=core/workflow_template_system --cov=core/workflow_parameter_validator --cov=core/workflow_ui_endpoints --cov=core/workflow_template_endpoints --cov-report=term-missing
3. Confirm: No import errors or test collection failures
</verification>

<success_criteria>
- 4 new test files created
- All tests pass (no failures, minimal skips)
- Each target file shows >0% coverage (baseline established)
- Overall coverage increases by measurable amount
</success_criteria>

<output>
After completion, create `.planning/phases/08.5-coverage-expansion/08.5-coverage-expansion-01-SUMMARY.md` with:
- Lines of test code added
- Coverage percentage achieved for each file
- Any patterns or issues discovered
- Next file recommendations
</output>
