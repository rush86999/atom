---
phase: 15-codebase-completion
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - backend/docs/API_DOCUMENTATION.md
  - backend/core/atom_agent_endpoints.py
  - backend/api/health_routes.py
  - backend/api/skill_routes.py
autonomous: true

must_haves:
  truths:
    - "All REST API endpoints have OpenAPI documentation (summary, description, responses)"
    - "API documentation is accessible via /docs (Swagger UI) and /redoc (ReDoc)"
    - "Critical endpoints have request/response examples"
    - "Authentication requirements are documented for each endpoint"
  artifacts:
    - path: "backend/docs/API_DOCUMENTATION.md"
      provides: "Comprehensive API documentation for all REST endpoints"
      contains: "## API Endpoints"
    - path: "backend/core/atom_agent_endpoints.py"
      provides: "Example of documented endpoint with OpenAPI decorators"
      contains: "@app.post\\("
  key_links:
    - from: "backend/docs/API_DOCUMENTATION.md"
      to: "backend/core/atom_agent_endpoints.py"
      via: "endpoint documentation reference"
      pattern: "`/api/agents/{id}/chat`"
    - from: "backend/main_api_app.py"
      to: "backend/docs/API_DOCUMENTATION.md"
      via: "OpenAPI spec generation"
      pattern: "app.openapi\\(\\)"
---

<objective>
Create comprehensive API documentation for all REST endpoints with OpenAPI specification and usage examples.

Purpose: Production systems require complete API documentation for integration, testing, and client development. FastAPI auto-generates OpenAPI docs but many endpoints lack detailed descriptions and examples.

Output: Complete API documentation file, enhanced OpenAPI spec with examples, endpoint testing guide.
</objective>

<execution_context>
@/Users/rushiparikh/.claude/get-shit-done/workflows/execute-plan.md
@/Users/rushiparikh/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/15-codebase-completion/15-RESEARCH.md
@.planning/ROADMAP.md

# FastAPI OpenAPI patterns from Phase 03-integration-security-tests
- Use @app decorator parameters: summary, description, tags, responses
- Request body models with Pydantic for automatic schema generation
- Response models with Pydantic for automatic schema validation
- Use HTTPException for error responses

# API routes from previous phases
- Agent endpoints: atom_agent_endpoints.py
- Skill endpoints: skill_routes.py (Phase 14)
- Health endpoints: health_routes.py (Plan 02)
- Canvas/Browser/Device endpoints from Phase 8
</context>

<tasks>

<task type="auto">
  <name>Task 1: Audit API endpoints and enhance OpenAPI documentation</name>
  <files>backend/core/atom_agent_endpoints.py, backend/api/health_routes.py, backend/api/skill_routes.py</files>
  <action>
    1. Use grep/find to identify all API route files in backend:
       - backend/core/*_endpoints.py
       - backend/api/*_routes.py

    2. For each endpoint, enhance OpenAPI documentation:
       - Add summary: Brief one-line description
       - Add description: Detailed explanation with parameters
       - Add tags: For grouping in Swagger UI
       - Add responses: Document all status codes (200, 400, 401, 403, 404, 500)
       - Add request_body examples for POST/PUT endpoints
       - Add response examples for all endpoints

    3. Focus on critical endpoints first:
       - Agent chat: POST /api/agents/{id}/chat
       - Agent status: GET /api/agents/{id}/status
       - Skill execution: POST /api/skills/{id}/execute
       - Health checks: GET /health/live, GET /health/ready
       - Canvas operations: POST /api/canvas/present

    4. Add OpenAPI extensions where needed:
       - x-auth-required: true for protected endpoints
       - x-governance: maturity level requirements
       - x-rate-limit: rate limit information

    Per FastAPI best practices:
    - Use Pydantic models for request/response schemas
    - Document all query parameters with description
    - Add examples for complex request bodies
  </action>
  <verify>
    Command: `cd backend && python -c "from main_api_app import app; routes = [r for r in app.routes if hasattr(r, 'methods')]; print(f'{len(routes)} routes found')"`
    Expected: 50+ routes with OpenAPI documentation
  </verify>
  <done>
    All API endpoints have enhanced OpenAPI documentation
  </done>
</task>

<task type="auto">
  <name>Task 2: Create comprehensive API documentation file</name>
  <files>backend/docs/API_DOCUMENTATION.md</files>
  <action>
    1. Create backend/docs/API_DOCUMENTATION.md with:
       - API overview and base URL
       - Authentication documentation (JWT tokens, API keys)
       - Governance requirements by maturity level
       - Endpoint sections organized by domain:
         - Agent endpoints (chat, status, execution)
         - Skill endpoints (execute, list, import)
         - Canvas endpoints (present, submit, close)
         - Browser automation endpoints
         - Device capability endpoints
         - Health check endpoints
         - Social feed endpoints
         - Shell access endpoints
       - For each endpoint:
         - HTTP method and path
         - Description
         - Authentication requirements
         - Governance requirements
         - Request parameters (path, query, body)
         - Response format
         - Error responses
         - Example requests/responses

    2. Include OpenAPI spec reference:
       - Swagger UI: /docs
       - ReDoc: /redoc
       - OpenAPI JSON: /openapi.json

    3. Add integration examples:
       - cURL examples
       - Python requests examples
       - JavaScript fetch examples
  </action>
  <verify>
    Command: `grep -c "##" backend/docs/API_DOCUMENTATION.md`
    Expected: 20+ sections (one per endpoint group)
  </verify>
  <done>
    API documentation file created with complete endpoint reference
  </done>
</task>

<task type="auto">
  <name>Task 3: Create API testing guide and SUMMARY</name>
  <files>backend/docs/API_TESTING_GUIDE.md, .planning/phases/15-codebase-completion/15-03-SUMMARY.md</files>
  <action>
    1. Create backend/docs/API_TESTING_GUIDE.md with:
       - Local testing setup (start server, get auth token)
       - Testing authenticated endpoints
       - Testing governance-protected endpoints
       - Using Swagger UI for interactive testing
       - Common testing scenarios (agent chat, skill execution, canvas)
       - Error handling and response codes reference

    2. Create SUMMARY.md documenting:
       - Number of endpoints documented
       - OpenAPI enhancements made
       - API documentation structure
       - Testing guide created
       - Remaining work (runbooks, deployment docs)

    3. Verify /docs and /redoc endpoints work:
       - Start server: `uvicorn main_api_app:app --reload`
       - Visit http://localhost:8000/docs
       - Visit http://localhost:8000/redoc
  </action>
  <verify>
    Command: `grep -E "^(GET|POST|PUT|DELETE)" backend/docs/API_DOCUMENTATION.md | wc -l`
    Expected: 40+ documented endpoints
  </verify>
  <done>
    API testing guide created, SUMMARY.md complete, OpenAPI docs verified
  </done>
</task>

</tasks>

<verification>
1. Start server and visit /docs: Swagger UI should display all endpoints
2. Visit /redoc: ReDoc should display formatted API docs
3. Check API_DOCUMENTATION.md: Should have all major endpoint groups documented
4. Check API_TESTING_GUIDE.md: Should have testing examples for common scenarios
5. Verify endpoint examples: `grep -A 5 "Example:" backend/docs/API_DOCUMENTATION.md`
</verification>

<success_criteria>
1. All REST endpoints have OpenAPI documentation (summary, description, tags)
2. /docs (Swagger UI) and /redoc (ReDoc) accessible and functional
3. API_DOCUMENTATION.md covers all endpoint domains
4. API_TESTING_GUIDE.md provides practical testing examples
5. SUMMARY.md documents documentation completion
</success_criteria>

<output>
After completion, create `.planning/phases/15-codebase-completion/15-03-SUMMARY.md`
</output>
